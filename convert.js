// Generated by CoffeeScript 1.3.1
var draw, parse, tag;

tag = function(id) {
  return document.getElementById(id);
};

parse = function(arr) {
  var recurse;
  return (recurse = function() {
    var head, in_brackets;
    head = arr.shift();
    if (head === '(') {
      in_brackets = [];
      while (arr[0] !== ')') {
        in_brackets.push(recurse());
      }
      arr.shift();
      return in_brackets;
    } else {
      return head;
    }
  })();
};

draw = function(arr) {
  var item, str, _i, _len;
  console.log('draw');
  str = '';
  console.log('arr:', arr);
  for (_i = 0, _len = arr.length; _i < _len; _i++) {
    item = arr[_i];
    if (typeof item === 'string') {
      str += "<div class='atom'>" + item + "</div>";
    } else if (typeof item === 'object') {
      console.log('item', item);
      str += "<div class='exp'>" + (draw(item)) + "</div>";
    }
  }
  return str;
};

window.onload = function() {
  var result, source;
  textareaEditor('source');
  source = tag('source');
  result = tag('result');
  return source.oninput = function() {
    var arr;
    if (source.value.length < 4) {
      return 0;
    }
    arr = ("(" + source.value + ")").replace(/\(/g, ' ( ').replace(/\)/g, ' ) ').split(' ').filter(function(x) {
      return x.length > 0;
    });
    return result.innerHTML = draw(parse(arr));
  };
};
